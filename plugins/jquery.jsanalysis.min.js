/*
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU Lesser General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Lesser General Public License for more details.
 You should have received a copy of the GNU Lesser General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 jQuery.factorial=function(a){fact=1;for(i=a;i>0;i--){fact*=i}return fact};jQuery.combination=function(b,a){return jQuery.factorial(b)/jQuery.factorial(a)/jQuery.factorial(b-a)};jQuery.permutation=function(b,a){return jQuery.factorial(b)/jQuery.factorial(b-a)};jQuery.gamma=function(x){if(x>0){if(x!=Math.floor(x)){with(Math){var v=1;while(x<8){v*=x;x++}var w=1/(x*x);return exp(((((((((-3617/122400)*w+7/1092)*w-691/360360)*w+5/5940)*w-1/1680)*w+1/1260)*w-1/360)*w+1/12)/x+0.5*log(2*PI)-log(v)-x+(x-0.5)*log(x))}}else{return jQuery.factorial(x-1)}}return false};jQuery.precision=function(a,b){var c=Math.pow(10,Math.floor(Math.log(1/b)*Math.LOG10E));return Math.round(c*a)/c};jQuery.minimum=function(a){var b=a[0];for(i=0;i<a.length;i++){if(a[i]<b){b=a[i]}}return b};jQuery.maximum=function(b){var a=b[0];for(i=0;i<b.length;i++){if(b[i]>a){a=b[i]}}return a};jQuery.mean=function(a){return jQuery.sum(a)/a.length};jQuery.sum=function(a){var b=0;for(i=0;i<a.length;i++){b+=a[i]}return b};jQuery.mode=function(c){var e=c.sort(function(j,h){return j-h});var f=1;var b=0;var g=[];var d=[];for(i=0;i<e.length;i++){if(e[i]==e[i+1]){f++}else{g[b]=f;d[b]=e[i];b++;f=1}}var a=g[0];for(i=0;i<g.length;i++){if(g[i]>a){a=g[i];b=i}}return d[b]};jQuery.median=function(a){var b=a.sort(function(d,c){return d-c});return b[Math.round((a.length)/2)-1]};jQuery.quartiles=function(a){var b=a.sort(function c(e,d){return e-d});return[b[Math.round((b.length)/4)-1],b[Math.round((b.length)/2)-1],b[Math.round((b.length)*3/4)-1]]};jQuery.variance=function(a){var c=[];var b=jQuery.mean(a);for(i=0;i<a.length;i++){c[i]=Math.pow(a[i]-b,2)}return jQuery.sum(c)/a.length};jQuery.meandev=function(a){var b=[];var c=jQuery.mean(a);for(i=0;i<a.length;i++){b[i]=Math.abs(a[i]-c)}return jQuery.sum(b)/a.length};jQuery.stdev=function(a){return Math.sqrt(jQuery.variance(a))};jQuery.covariance=function(d,b){var c=jQuery.mean(d);var a=jQuery.mean(b);var e=[];for(i=0;i<d.length;i++){e[i]=(d[i]-c)*(b[i]-a)}return jQuery.sum(e)/d.length};jQuery.corr_coeff=function(b,a){return jQuery.covariance(b,a)/jQuery.stdev(b)/jQuery.stdev(a)};jQuery.uniformcdf=function(e,d,c){if(c<e){return 0}else{if(c<d){return(c-e)/(d-e)}}return 1};jQuery.binomial=function(c,b,a){return jQuery.combination(c,a)*Math.pow(b,a)*Math.pow(1-b,c-a)};jQuery.binomialcdf=function(e,d,a){if(a<0){return 0}var c=[];for(k=0;k<e;k++){c[k]=jQuery.binomial(e,d,k)}if(a<e){var b=0;for(i=0;i<=a;i++){b+=c[i]}return b}return 1};jQuery.negbin=function(b,c,a){if(a!=Math.floor(a)){return false}if(a<0){return 0}else{return jQuery.combination(a+b-1,b-1)*Math.pow(c,b)*Math.pow(1-c,a)}};jQuery.negbincdf=function(d,c,a){if(a<0){return 0}var b=0;for(k=0;k<=a;k++){b+=jQuery.negbin(d,c,k)}return b};jQuery.hypgeom=function(c,b,d,a){if(a!=Math.floor(a)){return false}if(a<0){return 0}else{return jQuery.combination(b,a)*jQuery.combination((c-b),d-a)/jQuery.combination(c,d)}};jQuery.hypgeomcdf=function(d,b,e,a){if(a<0){return 0}var c=0;for(k=0;k<=a;k++){c+=jQuery.hypgeom(d,b,e,k)}return c};jQuery.exponentialcdf=function(b,a){return 1-Math.exp(-1*a)};jQuery.poisson=function(b,a){return Math.pow(b,a)*Math.exp(-b)/jQuery.factorial(a)};jQuery.poissoncdf=function(b,a){if(a<0){return 0}var c=0;for(k=0;k<=a;k++){c+=jQuery.poisson(b,k)}return c};jQuery.normcdf=function(a,c,b){return jQuery.asr(Function("x","return Math.exp(-Math.pow(x-"+a+",2)/Math.pow("+c+",2)/2)/"+c+"/Math.sqrt(2*Math.PI)"),0,b,1e-14)};jQuery.linear_reg_eq=function(f,h){var c=jQuery.mean(f);var a=jQuery.mean(h);var g=[];var e=[];for(i=0;i<f.length;i++){g[i]=(f[i]-c)*(h[i]-a);e[i]=Math.pow(h[i]-a,2)}var d=jQuery.sum(g)/jQuery.sum(e);var b=c-d*a;return Function("x","return "+d+"*x+"+b)};jQuery.exp_reg_eq=function(e,h){for(i=0;i<e.length;i++){(e[i]=Math.log(e[i]))}var c=jQuery.mean(e);var b=jQuery.mean(h);var f=[];var d=[];for(i=0;i<e.length;i++){f[i]=(e[i]-c)*(h[i]-b);d[i]=Math.pow(h[i]-b,2)}var a=jQuery.sum(f)/jQuery.sum(d);var g=Math.exp(c-a*b);return Function("x","return Math.exp("+a+"*x)*"+g)};jQuery.secantmethod=function(e,c,a,b,h){var g;for(n=1;n<=h;n++){var f=e(a);g=(a-c)/(f-e(c))*f;if(Math.abs(g)<b){return a}c=a;a=a-g}return a};jQuery.fivept=function(c,a,b){return(-c(a+b*2)+8*c(a+b)-8*c(a-b)+c(a-b*2))/b/12};jQuery.fcrit=function(e,d,c){return jQuery.precision(jQuery.secantmethod(Function("t","return jQuery.fivept("+e+",t,1e-3)"),d,c,1e-13,99999),1e-12)};jQuery.asr=function(m,q,p,r){var o=(q+p)/2;var l=(p-q)/6;var g=m(q);var e=m(p);var d=m(o);var j=function(y,E,C,B,H,z,w,v,t){var G=(E+B)/2;var A=(B+C)/2;var x=(B-E)/6;var D=y(A);var s=y(G);var u=(w+4*s+t)*x;var F=(t+4*D+v)*x;if(Math.abs(u+F-z)<=15*H){return u+F+(u+F-z)/15}return j(y,E,B,G,H/2,u,w,t,s)+j(y,B,C,A,H/2,F,t,v,D)};return jQuery.precision(j(m,q,p,o,r,l*(g+e+4*d),g,e,d),r)};